<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ransomware Detection System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .header h1 {
            color: #2d3748;
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(31, 38, 135, 0.5);
        }

        .status-card h3 {
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .status-value {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .status-normal { color: #38a169; }
        .status-warning { color: #d69e2e; }
        .status-danger { color: #e53e3e; }

        .main-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .alerts-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            max-height: 600px;
            overflow-y: auto;
        }

        .alert-item {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 10px;
            border-left: 4px solid;
            animation: slideIn 0.5s ease-out;
        }

        .alert-high {
            background: rgba(254, 178, 178, 0.3);
            border-left-color: #e53e3e;
        }

        .alert-medium {
            background: rgba(251, 211, 141, 0.3);
            border-left-color: #d69e2e;
        }

        .alert-low {
            background: rgba(154, 230, 180, 0.3);
            border-left-color: #38a169;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .control-button {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .control-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5);
        }

        .control-button:active {
            transform: translateY(0);
        }

        .details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .details-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .feature-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .feature-item:last-child {
            border-bottom: none;
        }

        .feature-name {
            font-weight: 600;
            color: #4a5568;
        }

        .feature-value {
            font-family: monospace;
            background: rgba(102, 126, 234, 0.1);
            padding: 4px 8px;
            border-radius: 5px;
        }

        .log-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
            height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.9em;
            line-height: 1.4;
        }

        .log-entry {
            margin-bottom: 5px;
            padding: 5px;
            border-radius: 3px;
        }

        .log-info { background: rgba(66, 153, 225, 0.1); }
        .log-warning { background: rgba(237, 137, 54, 0.1); }
        .log-error { background: rgba(245, 101, 101, 0.1); }

        .prediction-display {
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            font-size: 1.2em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .prediction-benign {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
        }

        .prediction-ransomware {
            background: linear-gradient(45deg, #f56565, #e53e3e);
            color: white;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .risk-meter {
            position: relative;
            width: 200px;
            height: 200px;
            margin: 20px auto;
        }

        .risk-meter svg {
            transform: rotate(-90deg);
        }

        .risk-meter-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 2em;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                grid-template-columns: 1fr;
            }
            
            .details-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Ransomware Detection System</h1>
            <p>Real-time explainable ransomware detection for resource-constrained environments</p>
            <div class="prediction-display" id="currentPrediction">
                System Status: Monitoring...
            </div>
        </div>

        <div class="controls">
            <button class="control-button" onclick="startMonitoring()">Start Monitoring</button>
            <button class="control-button" onclick="stopMonitoring()">Stop Monitoring</button>
            <button class="control-button" onclick="generateTestData()">Generate Test Data</button>
            <button class="control-button" onclick="exportReport()">Export Report</button>
        </div>

        <div class="status-bar">
            <div class="status-card">
                <h3>Risk Score</h3>
                <div class="status-value" id="riskScore">0.00</div>
                <div class="risk-meter">
                    <svg width="200" height="200">
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#e2e8f0" stroke-width="10"/>
                        <circle cx="100" cy="100" r="80" fill="none" stroke="#667eea" stroke-width="10" 
                                stroke-dasharray="502.4" stroke-dashoffset="502.4" id="riskCircle"/>
                    </svg>
                    <div class="risk-meter-value" id="riskMeterValue">0%</div>
                </div>
            </div>
            
            <div class="status-card">
                <h3>Active Alerts</h3>
                <div class="status-value status-normal" id="activeAlerts">0</div>
                <small>Last hour</small>
            </div>
            
            <div class="status-card">
                <h3>File Operations</h3>
                <div class="status-value status-normal" id="fileOps">0</div>
                <small>Per minute</small>
            </div>
            
            <div class="status-card">
                <h3>Suspicious Processes</h3>
                <div class="status-value status-normal" id="suspiciousProcs">0</div>
                <small>Currently active</small>
            </div>
        </div>

        <div class="main-grid">
            <div class="chart-container">
                <h3>Risk Score Timeline</h3>
                <canvas id="riskChart" width="400" height="200"></canvas>
            </div>
            
            <div class="alerts-container">
                <h3>Recent Alerts</h3>
                <div id="alertsList">
                    <div class="alert-item alert-low">
                        <strong>System Started</strong><br>
                        <small>Ransomware detection system initialized successfully</small>
                    </div>
                </div>
            </div>
        </div>

        <div class="details-grid">
            <div class="details-card">
                <h3>Current Features</h3>
                <div id="currentFeatures">
                    <div class="feature-item">
                        <span class="feature-name">File Ops/Min</span>
                        <span class="feature-value" id="feat-fileOps">0</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-name">CPU Usage</span>
                        <span class="feature-value" id="feat-cpu">0%</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-name">Memory Usage</span>
                        <span class="feature-value" id="feat-memory">0%</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-name">Network Connections</span>
                        <span class="feature-value" id="feat-network">0</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-name">Active Processes</span>
                        <span class="feature-value" id="feat-processes">0</span>
                    </div>
                </div>
            </div>
            
            <div class="details-card">
                <h3>Feature Explanations</h3>
                <div id="explanations">
                    <p>Start monitoring to see feature explanations...</p>
                </div>
            </div>
            
            <div class="details-card">
                <h3>Process Monitor</h3>
                <canvas id="processChart" width="300" height="200"></canvas>
            </div>
        </div>

        <div class="details-grid">
            <div class="log-container">
                <h3>System Logs</h3>
                <div id="systemLogs">
                    <div class="log-entry log-info">[INFO] Ransomware detection system initialized</div>
                </div>
            </div>
            
            <div class="details-card">
                <h3>Detection Statistics</h3>
                <canvas id="statsChart" width="300" height="200"></canvas>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let monitoring = false;
        let riskChart, processChart, statsChart;
        let riskData = [];
        let processData = [];
        let detectionStats = { benign: 0, ransomware: 0 };

        // Initialize charts
        function initializeCharts() {
            // Risk Score Chart
            const riskCtx = document.getElementById('riskChart').getContext('2d');
            riskChart = new Chart(riskCtx, {
                type: 'line',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Risk Score',
                        data: [],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });

            // Process Chart
            const processCtx = document.getElementById('processChart').getContext('2d');
            processChart = new Chart(processCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Normal', 'Suspicious'],
                    datasets: [{
                        data: [100, 0],
                        backgroundColor: ['#48bb78', '#f56565'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // Statistics Chart
            const statsCtx = document.getElementById('statsChart').getContext('2d');
            statsChart = new Chart(statsCtx, {
                type: 'bar',
                data: {
                    labels: ['Benign', 'Ransomware'],
                    datasets: [{
                        label: 'Detections',
                        data: [0, 0],
                        backgroundColor: ['#48bb78', '#f56565'],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Simulate real-time data
        function generateRealtimeData() {
            if (!monitoring) return;

            // Simulate risk score
            const baseRisk = Math.random() * 0.3; // Base risk
            let riskScore = baseRisk;
            
            // Occasionally simulate ransomware detection
            if (Math.random() < 0.05) { // 5% chance
                riskScore = 0.7 + Math.random() * 0.3; // High risk
            }

            // Update risk score display
            updateRiskScore(riskScore);

            // Simulate system features
            const features = {
                fileOps: Math.floor(Math.random() * 50),
                cpu: Math.floor(Math.random() * 100),
                memory: Math.floor(Math.random() * 100),
                network: Math.floor(Math.random() * 20),
                processes: Math.floor(Math.random() * 100) + 50
            };

            updateFeatures(features);

            // Generate alerts for high risk
            if (riskScore > 0.7) {
                addAlert('High Risk Detected', 'high', 
                    `Risk score: ${riskScore.toFixed(2)} - Multiple suspicious indicators detected`);
            } else if (riskScore > 0.5) {
                addAlert('Medium Risk Detected', 'medium', 
                    `Risk score: ${riskScore.toFixed(2)} - Some suspicious activity observed`);
            }

            // Update detection stats
            if (riskScore > 0.5) {
                detectionStats.ransomware++;
            } else {
                detectionStats.benign++;
            }

            updateCharts(riskScore);
            updatePrediction(riskScore);

            // Add system log
            addSystemLog(`Detection completed - Risk: ${riskScore.toFixed(3)}, Features: ${JSON.stringify(features)}`, 'info');
        }

        function updateRiskScore(score) {
            const riskElement = document.getElementById('riskScore');
            const riskMeter = document.getElementById('riskMeterValue');
            const riskCircle = document.getElementById('riskCircle');
            
            riskElement.textContent = score.toFixed(2);
            riskMeter.textContent = Math.round(score * 100) + '%';
            
            // Update risk meter color and progress
            const circumference = 502.4;
            const progress = circumference - (score * circumference);
            riskCircle.style.strokeDashoffset = progress;
            
            if (score > 0.7) {
                riskElement.className = 'status-value status-danger';
                riskCircle.style.stroke = '#e53e3e';
            } else if (score > 0.4) {
                riskElement.className = 'status-value status-warning';
                riskCircle.style.stroke = '#d69e2e';
            } else {
                riskElement.className = 'status-value status-normal';
                riskCircle.style.stroke = '#38a169';
            }
        }

        function updateFeatures(features) {
            document.getElementById('feat-fileOps').textContent = features.fileOps;
            document.getElementById('feat-cpu').textContent = features.cpu + '%';
            document.getElementById('feat-memory').textContent = features.memory + '%';
            document.getElementById('feat-network').textContent = features.network;
            document.getElementById('feat-processes').textContent = features.processes;

            // Update status cards
            document.getElementById('fileOps').textContent = features.fileOps;
            document.getElementById('suspiciousProcs').textContent = Math.floor(features.processes * 0.1);
        }

        function updatePrediction(riskScore) {
            const predictionElement = document.getElementById('currentPrediction');
            
            if (riskScore > 0.5) {
                predictionElement.textContent = 'RANSOMWARE DETECTED';
                predictionElement.className = 'prediction-display prediction-ransomware';
            } else {
                predictionElement.textContent = 'SYSTEM SECURE';
                predictionElement.className = 'prediction-display prediction-benign';
            }
        }

        function updateCharts(riskScore) {
            const now = new Date().toLocaleTimeString();
            
            // Update risk chart
            if (riskChart.data.labels.length > 20) {
                riskChart.data.labels.shift();
                riskChart.data.datasets[0].data.shift();
            }
            
            riskChart.data.labels.push(now);
            riskChart.data.datasets[0].data.push(riskScore);
            riskChart.update();

            // Update process chart
            const suspiciousProcs = riskScore > 0.5 ? Math.floor(riskScore * 100) : 10;
            const normalProcs = 100 - suspiciousProcs;
            
            processChart.data.datasets[0].data = [normalProcs, suspiciousProcs];
            processChart.update();

            // Update stats chart
            statsChart.data.datasets[0].data = [detectionStats.benign, detectionStats.ransomware];
            statsChart.update();
        }

        function addAlert(title, severity, details) {
            const alertsList = document.getElementById('alertsList');
            const alertItem = document.createElement('div');
            alertItem.className = `alert-item alert-${severity}`;
            alertItem.innerHTML = `
                <strong>${title}</strong><br>
                <small>${details}</small><br>
                <em>${new Date().toLocaleTimeString()}</em>
            `;
            
            alertsList.insertBefore(alertItem, alertsList.firstChild);
            
            // Keep only last 10 alerts
            while (alertsList.children.length > 10) {
                alertsList.removeChild(alertsList.lastChild);
            }

            // Update alert count
            const alertCount = document.querySelectorAll('.alert-item').length;
            document.getElementById('activeAlerts').textContent = alertCount;
        }

        function addSystemLog(message, level) {
            const logsContainer = document.getElementById('systemLogs');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${level}`;
            logEntry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            
            logsContainer.insertBefore(logEntry, logsContainer.firstChild);
            
            // Keep only last 50 logs
            while (logsContainer.children.length > 50) {
                logsContainer.removeChild(logsContainer.lastChild);
            }
        }

        function updateExplanations() {
            const explanationsDiv = document.getElementById('explanations');
            
            if (!monitoring) {
                explanationsDiv.innerHTML = '<p>Start monitoring to see feature explanations...</p>';
                return;
            }

            // Simulate feature explanations
            const explanations = [
                { feature: 'File Operations Rate', impact: 'High', description: 'Elevated file activity detected' },
                { feature: 'Process CPU Usage', impact: 'Medium', description: 'Some processes using high CPU' },
                { feature: 'Network Connections', impact: 'Low', description: 'Normal network activity' }
            ];

            let html = '';
            explanations.forEach(exp => {
                const impactClass = exp.impact.toLowerCase();
                html += `
                    <div class="feature-item">
                        <div>
                            <strong>${exp.feature}</strong><br>
                            <small>${exp.description}</small>
                        </div>
                        <span class="feature-value status-${impactClass === 'high' ? 'danger' : impactClass === 'medium' ? 'warning' : 'normal'}">${exp.impact}</span>
                    </div>
                `;
            });
            
            explanationsDiv.innerHTML = html;
        }

        // Control functions
        function startMonitoring() {
            monitoring = true;
            addSystemLog('Monitoring started', 'info');
            addAlert('Monitoring Started', 'low', 'Real-time ransomware detection is now active');
            
            // Start simulation interval
            window.monitoringInterval = setInterval(generateRealtimeData, 2000);
            window.explanationInterval = setInterval(updateExplanations, 5000);
        }

        function stopMonitoring() {
            monitoring = false;
            clearInterval(window.monitoringInterval);
            clearInterval(window.explanationInterval);
            
            addSystemLog('Monitoring stopped', 'info');
            addAlert('Monitoring Stopped', 'low', 'Real-time detection has been paused');
            
            document.getElementById('currentPrediction').textContent = 'MONITORING STOPPED';
            document.getElementById('currentPrediction').className = 'prediction-display';
        }

        function generateTestData() {
            addSystemLog('Generating test ransomware scenario', 'warning');
            
            // Simulate ransomware attack
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const highRisk = 0.8 + Math.random() * 0.2;
                    updateRiskScore(highRisk);
                    updateCharts(highRisk);
                    updatePrediction(highRisk);
                    
                    addAlert('Test Ransomware Activity', 'high', 
                        `Simulated ransomware behavior - Risk: ${highRisk.toFixed(2)}`);
                }, i * 1000);
            }
        }

        function exportReport() {
            const reportData = {
                timestamp: new Date().toISOString(),
                detectionStats: detectionStats,
                riskData: riskData.slice(-50),
                alerts: Array.from(document.querySelectorAll('.alert-item')).map(alert => ({
                    content: alert.textContent,
                    severity: alert.className.includes('high') ? 'high' : 
                             alert.className.includes('medium') ? 'medium' : 'low'
                }))
            };

            const dataStr = JSON.stringify(reportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `ransomware_report_${new Date().getTime()}.json`;
            link.click();
            
            addSystemLog('Report exported successfully', 'info');
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            updateExplanations();
            
            // Auto-start monitoring for demo
            setTimeout(startMonitoring, 1000);
        });
    </script>
</body>
</html>